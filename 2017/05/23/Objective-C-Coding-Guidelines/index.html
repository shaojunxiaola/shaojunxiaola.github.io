<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content=""><title>Objective-C Coding Guidelines | Xiao</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.1/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.1/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.4.1/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><script type="text/javascript" src="//lib.baomitu.com/clipboard.js/2.0.4/clipboard.min.js"></script><script type="text/javascript" src="//lib.baomitu.com/toastr.js/2.1.4/toastr.min.js"></script><link rel="stylesheet" href="//lib.baomitu.com/toastr.js/2.1.4/toastr.min.css"><meta name="generator" content="Hexo 4.2.0"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">Objective-C Coding Guidelines</h1><a id="logo" href="/.">Xiao</a><p class="description">世界很美，而你正好有空</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">Objective-C Coding Guidelines</h1><div class="post-meta">2017-05-23<span> | </span><span class="category"><a href="/categories/iOS/">iOS</a></span></div><div class="post-content"><h2 id="概要"><a href="#概要" class="headerlink" title="概要"></a>概要</h2><p>Objective-C 是一门面向对象的动态编程语言，主要用于编写 iOS 和 Mac 应用程序。本文结合苹果 Coding Guidelines 文档，总结出一份通用的 Objective-C 编码规范。</p>
<h2 id="一、代码格式"><a href="#一、代码格式" class="headerlink" title="一、代码格式"></a>一、代码格式</h2><h3 id="1-1-函数的书写"><a href="#1-1-函数的书写" class="headerlink" title="1.1 函数的书写"></a>1.1 函数的书写</h3><p>一个典型的Objective-C函数应该是这样的：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">instancetype</span>)initWithAuthName:(<span class="built_in">NSString</span> *)authName password:(<span class="built_in">NSString</span> *)password token:(<span class="built_in">NSString</span> *)token &#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在<code>-</code>和<code>(void)</code>之间应该有一个空格，第一个大括号<code>{</code>的位置在函数所在行的末尾，同样应该有一个空格。</p>
<p>如果一个函数有特别多的参数或者名称很长，可以将其按照<code>:</code>来对齐分行显示：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">instancetype</span>)initWithAuthName:(<span class="built_in">NSString</span> *)authName</span><br><span class="line">                        password:(<span class="built_in">NSString</span> *)password</span><br><span class="line">                           token:(<span class="built_in">NSString</span> *)token</span><br><span class="line">                           email:(<span class="built_in">NSString</span> *)email</span><br><span class="line">                     phoneNumber:(<span class="built_in">NSString</span> *)phoneNumber;</span><br></pre></td></tr></table></figure>

<h3 id="1-2-函数调用"><a href="#1-2-函数调用" class="headerlink" title="1.2 函数调用"></a>1.2 函数调用</h3><p>函数调用的格式和书写差不多，可以按照函数的长短来选择写在一行或者分成多行：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">// 写在一行</span></span><br><span class="line">[myObject initWithAuthName:arg1 password:arg2 token:arg3];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 分行写，按照':'对齐</span></span><br><span class="line">[myObject initWithAuthName:arg1</span><br><span class="line">                  password:arg2</span><br><span class="line">                     token:arg3];</span><br><span class="line"></span><br><span class="line">以下写法是错误的：</span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误，要么写在一行，要么全部分行</span></span><br><span class="line">[myObject doFooWith:arg1 name:arg2</span><br><span class="line">              error:arg3];</span><br><span class="line">[myObject doFooWith:arg1</span><br><span class="line">               name:arg2 error:arg3];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误，按照':'来对齐，而不是关键字</span></span><br><span class="line">[myObject doFooWith:arg1</span><br><span class="line">          name:arg2</span><br><span class="line">          error:arg3];</span><br></pre></td></tr></table></figure>

<h3 id="1-3-public和-private标记符"><a href="#1-3-public和-private标记符" class="headerlink" title="1.3 @public和@private标记符"></a>1.3 @public和@private标记符</h3><p>@public和@private标记符应该以<strong>一个空格</strong>来进行缩进：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">MyClass</span> : <span class="title">NSObject</span> </span>&#123;</span><br><span class="line"> <span class="keyword">@public</span></span><br><span class="line">  ...</span><br><span class="line"> <span class="keyword">@private</span></span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<h3 id="1-4-协议（Protocols）"><a href="#1-4-协议（Protocols）" class="headerlink" title="1.4 协议（Protocols）"></a>1.4 协议（Protocols）</h3><p>在书写协议的时候注意用<code>&lt;&gt;</code>括起来的协议和类型名之间是没有空格的，这个规则适用所有书写协议的地方，包括函数声明、类声明、实例变量等等：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">StoreViewController</span> ()&lt;<span class="title">UITableViewDelegate</span>,<span class="title">UITableViewDataSource</span>,<span class="title">UITextFieldDelegate</span>,<span class="title">STSearchBarDelegate</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="1-5-闭包（Blocks）"><a href="#1-5-闭包（Blocks）" class="headerlink" title="1.5 闭包（Blocks）"></a>1.5 闭包（Blocks）</h3><p>根据block的长度，有不同的书写规则：</p>
<ul>
<li>如果分行显示的话，block的右括号<code>}</code>应该和调用block那行代码的第一个非空字符对齐。</li>
<li>block内的代码采用<strong>4个空格</strong>的缩进。</li>
<li><code>^</code>和<code>(</code>之间，<code>^</code>和<code>{</code>之间都没有空格，参数列表的右括号<code>)</code>和<code>{</code>之间有一个空格。</li>
</ul>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 较短的block写在一行内</span></span><br><span class="line">[operation setCompletionBlock:^&#123; [<span class="keyword">self</span> onOperationDone]; &#125;];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 分行书写的block，内部使用4空格缩进</span></span><br><span class="line">[operation setCompletionBlock:^&#123;</span><br><span class="line">    [<span class="keyword">self</span>.delegate newDataAvailable];</span><br><span class="line">&#125;];</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用C语言API调用的block遵循同样的书写规则</span></span><br><span class="line"><span class="built_in">dispatch_async</span>(_fileIOQueue, ^&#123;</span><br><span class="line">    <span class="built_in">NSString</span>* path = [<span class="keyword">self</span> sessionFilePath];</span><br><span class="line">    <span class="keyword">if</span> (path) &#123;</span><br><span class="line">      <span class="comment">// ...</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">// 较长的block关键字可以缩进后在新行书写，注意block的右括号'&#125;'和调用block那行代码的第一个非空字符对齐</span></span><br><span class="line">[[SessionService sharedService]</span><br><span class="line">    loadWindowWithCompletionBlock:^(SessionWindow *window) &#123;</span><br><span class="line">        <span class="keyword">if</span> (window) &#123;</span><br><span class="line">          [<span class="keyword">self</span> windowDidLoad:window];</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          [<span class="keyword">self</span> errorLoadingWindow];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;];</span><br></pre></td></tr></table></figure>

<h3 id="1-6-语法糖"><a href="#1-6-语法糖" class="headerlink" title="1.6 语法糖"></a>1.6 语法糖</h3><p>应该使用可读性更好的语法糖来构造<code>NSArray</code>，<code>NSDictionary</code>等数据结构，避免使用冗长的<code>alloc</code>,<code>init</code>方法。</p>
<p>如果构造代码写在一行，需要在括号两端留有一个空格，使得被构造的元素于与构造语法区分开来：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 正确，在语法糖的"[]"或者"&#123;&#125;"两端留有空格</span></span><br><span class="line"><span class="built_in">NSArray</span> *array = @[ [foo description], <span class="string">@"Another String"</span>, [bar description] ];</span><br><span class="line"><span class="built_in">NSDictionary</span> *dict = @&#123; <span class="built_in">NSForegroundColorAttributeName</span> : [<span class="built_in">NSColor</span> redColor] &#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不正确，不留有空格降低了可读性</span></span><br><span class="line"><span class="built_in">NSArray</span> *array = @[[foo description], [bar description]];</span><br><span class="line"><span class="built_in">NSDictionary</span> *dict = @&#123;<span class="built_in">NSForegroundColorAttributeName</span>: [<span class="built_in">NSColor</span> redColor]&#125;;</span><br></pre></td></tr></table></figure>

<p>如果构造代码不写在一行内，构造元素需要使用<strong>两个空格</strong>来进行缩进，右括号<code>]</code>或者<code>}</code>写在新的一行，并且与调用语法糖那行代码的第一个非空字符对齐：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSArray</span> *array = @[</span><br><span class="line">  <span class="string">@"This"</span>,</span><br><span class="line">  <span class="string">@"is"</span>,</span><br><span class="line">  <span class="string">@"an"</span>,</span><br><span class="line">  <span class="string">@"array"</span></span><br><span class="line">];</span><br><span class="line"></span><br><span class="line"><span class="built_in">NSDictionary</span> *dictionary = @&#123;</span><br><span class="line">  <span class="built_in">NSFontAttributeName</span> : [<span class="built_in">NSFont</span> fontWithName:<span class="string">@"Helvetica-Bold"</span> size:<span class="number">12</span>],</span><br><span class="line">  <span class="built_in">NSForegroundColorAttributeName</span> : fontColor</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<h2 id="二、命名规范"><a href="#二、命名规范" class="headerlink" title="二、命名规范"></a>二、命名规范</h2><h3 id="2-1-基本原则"><a href="#2-1-基本原则" class="headerlink" title="2.1 基本原则"></a>2.1 基本原则</h3><h4 id="2-1-1-清晰"><a href="#2-1-1-清晰" class="headerlink" title="2.1.1 清晰"></a>2.1.1 清晰</h4><p>命名应该尽可能的清晰和简洁，但在Objective-C中，清晰比简洁更重要。由于Xcode强大的自动补全功能，我们不必担心名称过长的问题。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 清晰</span></span><br><span class="line">insertObject:atIndex:</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不清晰，insert的对象类型和at的位置属性没有说明</span></span><br><span class="line">insert:at:</span><br><span class="line"></span><br><span class="line"><span class="comment">// 清晰</span></span><br><span class="line">removeObjectAtIndex:</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不清晰，remove的对象类型没有说明，参数的作用没有说明</span></span><br><span class="line">remove:</span><br></pre></td></tr></table></figure>

<p>不要使用单词的简写，拼写出完整的单词：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 清晰</span></span><br><span class="line">destinationSelection</span><br><span class="line">setBackgroundColor:</span><br><span class="line"></span><br><span class="line"><span class="comment">// 不清晰，不要使用简写</span></span><br><span class="line">destSel</span><br><span class="line">setBkgdColor:</span><br></pre></td></tr></table></figure>
<p>然而，有部分单词简写在Objective-C编码过程中是非常常用的，以至于成为了一种规范，这些简写可以在代码中直接使用，下面列举了部分：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">alloc   == Allocate</span><br><span class="line">alt     == Alternate</span><br><span class="line">app     == Application</span><br><span class="line">calc    == Calculate</span><br><span class="line">dealloc == Deallocate</span><br><span class="line">func    == Function</span><br><span class="line">horiz   == Horizontal</span><br><span class="line">info    == Information</span><br><span class="line">init    == Initialize</span><br><span class="line">max     == Maximum</span><br><span class="line">min     == Minimum</span><br><span class="line">msg     == Message</span><br><span class="line">nib     == Interface Builder archive</span><br><span class="line">pboard  == Pasteboard</span><br><span class="line">rect    == Rectangle</span><br><span class="line">temp    == Temporary</span><br><span class="line">vert    == Vertical</span><br></pre></td></tr></table></figure>

<p>命名方法或者函数时要避免歧义</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 有歧义，是返回sendPort还是send一个Port？</span></span><br><span class="line">sendPort</span><br><span class="line"></span><br><span class="line"><span class="comment">// 有歧义，是返回一个名字属性的值还是display一个name的动作？</span></span><br><span class="line">displayName</span><br></pre></td></tr></table></figure>

<h4 id="2-1-2-一致性"><a href="#2-1-2-一致性" class="headerlink" title="2.1.2 一致性"></a>2.1.2 一致性</h4><p>整个工程的命名风格要保持一致性，最好和苹果SDK的代码保持统一。不同类中完成相似功能的方法应该叫一样的名字，比如我们总是用<code>count</code>来返回集合的个数，不能在A类中使用<code>count</code>而在B类中使用<code>getNumber</code>。</p>
<h3 id="2-2-使用前缀"><a href="#2-2-使用前缀" class="headerlink" title="2.2 使用前缀"></a>2.2 使用前缀</h3><p>如果代码需要打包成Framework给别的工程使用，或者工程项目非常庞大，需要拆分成不同的模块，使用命名前缀是非常有用的。</p>
<ul>
<li><p>前缀由大写的字母缩写组成，比如Cocoa中<code>NS</code>前缀代表Founation框架中的类，<code>IB</code>则代表Interface Builder框架。</p>
</li>
<li><p>可以在为类、协议、函数、常量以及typedef宏命名的时候使用前缀，但注意<strong>不要</strong>为成员变量或者方法使用前缀，因为他们本身就包含在类的命名空间内。</p>
</li>
<li><p>命名前缀的时候不要和苹果SDK框架冲突。</p>
</li>
</ul>
<h3 id="2-3-命名类和协议（Class-amp-Protocol）"><a href="#2-3-命名类和协议（Class-amp-Protocol）" class="headerlink" title="2.3 命名类和协议（Class&amp;Protocol）"></a>2.3 命名类和协议（Class&amp;Protocol）</h3><p>类名以大写字母开头，应该包含一个<em>名词</em>来表示它代表的对象类型，同时可以加上必要的前缀，比如<code>NSString</code>, <code>NSDate</code>, <code>NSScanner</code>, <code>NSApplication</code>等等。</p>
<p>而协议名称应该清晰地表示它所执行的行为，而且要和类名区别开来，所以通常使用<code>ing</code>词尾来命名一个协议，比如<code>NSCopying</code>,<code>NSLocking</code>。</p>
<p>有些协议本身包含了很多不相关的功能，主要用来为某一特定类服务，这时候可以直接用类名来命名这个协议，比如<code>NSObject</code>协议，它包含了id对象在生存周期内的一系列方法。</p>
<h3 id="2-4-命名头文件（Headers）"><a href="#2-4-命名头文件（Headers）" class="headerlink" title="2.4 命名头文件（Headers）"></a>2.4 命名头文件（Headers）</h3><p>源码的头文件名应该清晰地暗示它的功能和包含的内容：</p>
<ul>
<li><p>如果头文件内只定义了单个类或者协议，直接用类名或者协议名来命名头文件，比如<code>NSLocale.h</code>定义了<code>NSLocale</code>类。</p>
</li>
<li><p>如果头文件内定义了一系列的类、协议、类别，使用其中最主要的类名来命名头文件，比如<code>NSString.h</code>定义了<code>NSString</code>和<code>NSMutableString</code>。</p>
</li>
<li><p>每一个Framework都应该有一个和框架同名的头文件，包含了框架中所有公共类头文件的引用，比如<code>Foundation.h</code></p>
</li>
<li><p>Framework中有时候会实现在别的框架中类的类别扩展，这样的文件通常使用<code>被扩展的框架名</code>+<code>Additions</code>的方式来命名，比如<code>NSBundleAdditions.h</code>。</p>
</li>
</ul>
<h3 id="2-5-命名方法（Methods）"><a href="#2-5-命名方法（Methods）" class="headerlink" title="2.5 命名方法（Methods）"></a>2.5 命名方法（Methods）</h3><p>Objective-C的方法名通常都比较长，这是为了让程序有更好地可读性，按苹果的说法<strong>“好的方法名应当可以以一个句子的形式朗读出来”</strong>。</p>
<p>方法一般以小写字母打头，每一个后续的单词首字母大写，方法名中不应该有标点符号（<em>包括下划线</em>），有两个例外：</p>
<ul>
<li>可以用一些通用的大写字母缩写打头方法，比如<code>PDF</code>,<code>TIFF</code>等。</li>
<li>可以用带下划线的前缀来命名私有方法或者类别中的方法。</li>
</ul>
<p>如果方法表示让对象执行一个动作，使用动词打头来命名，注意不要使用<code>do</code>，<code>does</code>这种多余的关键字，动词本身的暗示就足够了：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 动词打头的方法表示让对象执行一个动作</span></span><br><span class="line">- (<span class="keyword">void</span>)invokeWithTarget:(<span class="keyword">id</span>)target;</span><br><span class="line">- (<span class="keyword">void</span>)selectTabViewItem:(<span class="built_in">NSTabViewItem</span> *)tabViewItem;</span><br></pre></td></tr></table></figure>

<p>如果方法是为了获取对象的一个属性值，直接用属性名称来命名这个方法，注意不要添加<code>get</code>或者其他的动词前缀：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 正确，使用属性名来命名方法</span></span><br><span class="line">- (<span class="built_in">NSSize</span>)cellSize;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误，添加了多余的动词前缀</span></span><br><span class="line">- (<span class="built_in">NSSize</span>)calcCellSize;</span><br><span class="line">- (<span class="built_in">NSSize</span>)getCellSize;</span><br></pre></td></tr></table></figure>

<p>对于有多个参数的方法，务必在每一个参数前都添加关键词，关键词应当清晰说明参数的作用：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 正确，保证每个参数都有关键词修饰</span></span><br><span class="line">- (<span class="keyword">void</span>)sendAction:(SEL)selector toObject:(<span class="keyword">id</span>)object forAllCells:(<span class="built_in">BOOL</span>)flag;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误，遗漏关键词</span></span><br><span class="line">- (<span class="keyword">void</span>)sendAction:(SEL)selector :(<span class="keyword">id</span>)object :(<span class="built_in">BOOL</span>)flag;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 正确</span></span><br><span class="line">- (<span class="keyword">id</span>)viewWithTag:(<span class="built_in">NSInteger</span>)tag;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误，关键词的作用不清晰</span></span><br><span class="line">- (<span class="keyword">id</span>)taggedView:(<span class="keyword">int</span>)tag;</span><br></pre></td></tr></table></figure>

<p>方法的参数命名也有一些需要注意的地方:</p>
<ul>
<li>和方法名类似，参数的第一个字母小写，后面的每一个单词首字母大写</li>
<li>不要在方法名中使用类似<code>pointer</code>,<code>ptr</code>这样的字眼去表示指针，参数本身的类型足以说明</li>
<li>不要使用只有一两个字母的参数名</li>
<li>不要使用简写，拼出完整的单词</li>
</ul>
<p>下面列举了一些常用参数名：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">action:(SEL)action</span><br><span class="line">target:(<span class="keyword">id</span>)target</span><br><span class="line">font:(<span class="built_in">UIFont</span> *)font</span><br><span class="line">textColor:(<span class="built_in">UIColor</span> *)textColor</span><br><span class="line">frame:(<span class="built_in">CGRect</span>)frame</span><br><span class="line">tag:(<span class="built_in">NSUInteger</span>)tag</span><br><span class="line">atIndex:(<span class="keyword">int</span>)index</span><br><span class="line">title:(<span class="built_in">NSString</span> *)title</span><br><span class="line">text:(<span class="built_in">NSString</span> *)text</span><br></pre></td></tr></table></figure>

<h3 id="2-6-存取方法（Accessor-Methods）"><a href="#2-6-存取方法（Accessor-Methods）" class="headerlink" title="2.6 存取方法（Accessor Methods）"></a>2.6 存取方法（Accessor Methods）</h3><p>存取方法是指用来获取和设置类属性值的方法，属性的不同类型，对应着不同的存取方法规范：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 属性是一个名词时的存取方法范式</span></span><br><span class="line">- (<span class="built_in">NSString</span> *)title;</span><br><span class="line">- (<span class="keyword">void</span>)setTitle:(<span class="built_in">NSString</span> *)aTitle;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 属性是一个形容词时存取方法的范式</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)isAdjective;</span><br><span class="line">- (<span class="keyword">void</span>)setAdjective:(<span class="built_in">BOOL</span>)flag;</span><br><span class="line"><span class="comment">// example</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)isEditable;</span><br><span class="line">- (<span class="keyword">void</span>)setEditable:(<span class="built_in">BOOL</span>)flag;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 属性是一个动词时存取方法的范式</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)showsAlpha;</span><br><span class="line">- (<span class="keyword">void</span>)setShowsAlpha:(<span class="built_in">BOOL</span>)flag;</span><br></pre></td></tr></table></figure>

<p>可以使用<code>can</code>,<code>should</code>,<code>will</code>等词来协助表达存取方法的意思，但不要使用<code>do</code>,和<code>does</code>：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 正确</span></span><br><span class="line">- (<span class="keyword">void</span>)setCanHide:(<span class="built_in">BOOL</span>)flag;</span><br><span class="line">- (<span class="built_in">BOOL</span>)canHide;</span><br><span class="line">- (<span class="keyword">void</span>)setShouldCloseDocument:(<span class="built_in">BOOL</span>)flag;</span><br><span class="line">- (<span class="built_in">BOOL</span>)shouldCloseDocument;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误，不要使用"do"或者"does"</span></span><br><span class="line">- (<span class="keyword">void</span>)setDoesAcceptGlyphInfo:(<span class="built_in">BOOL</span>)flag;</span><br><span class="line">- (<span class="built_in">BOOL</span>)doesAcceptGlyphInfo;</span><br></pre></td></tr></table></figure>

<h3 id="2-7-命名代理（Delegate）"><a href="#2-7-命名代理（Delegate）" class="headerlink" title="2.7 命名代理（Delegate）"></a>2.7 命名代理（Delegate）</h3><p>当特定的事件发生时，对象会触发它注册的代理方法。代理是Objective-C中常用的传递消息的方式。代理有它固定的命名范式。</p>
<p>一个代理方法的第一个参数是触发它的对象，第一个关键词是触发对象的类名，除非代理方法只有一个名为<code>sender</code>的参数：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 第一个关键词为触发委托的类名</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)tableView:(<span class="built_in">UITableView</span> *)tableView shouldSelectRow:(<span class="built_in">NSUInteger</span>)row;</span><br><span class="line">- (<span class="built_in">BOOL</span>)application:(<span class="built_in">NSApplication</span> *)sender openFile:(<span class="built_in">NSString</span> *)filename;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 当只有一个"sender"参数时可以省略类名</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)applicationOpenUntitledFile:(<span class="built_in">NSApplication</span> *)sender;</span><br></pre></td></tr></table></figure>

<p>根据代理方法触发的时机和目的，可以使用<code>should</code>,<code>will</code>,<code>did</code>等关键词</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)browserDidScroll:(<span class="built_in">NSBrowser</span> *)sender;</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">NSUndoManager</span> *)windowWillReturnUndoManager:(<span class="built_in">NSWindow</span> *)window;、</span><br><span class="line"></span><br><span class="line">- (<span class="built_in">BOOL</span>)windowShouldClose:(<span class="keyword">id</span>)sender;</span><br></pre></td></tr></table></figure>

<h3 id="2-8-集合操作类方法（Collection-Methods）"><a href="#2-8-集合操作类方法（Collection-Methods）" class="headerlink" title="2.8 集合操作类方法（Collection Methods）"></a>2.8 集合操作类方法（Collection Methods）</h3><p>有些对象管理着一系列其它对象或者元素的集合，需要使用类似“增删查改”的方法来对集合进行操作，这些方法的命名范式一般为：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//集合操作范式</span></span><br><span class="line">- (<span class="keyword">void</span>)addElement:(elementType)anObj;</span><br><span class="line">- (<span class="keyword">void</span>)removeElement:(elementType)anObj;</span><br><span class="line">- (<span class="built_in">NSArray</span> *)elements;</span><br><span class="line"></span><br><span class="line"><span class="comment">// example</span></span><br><span class="line">- (<span class="keyword">void</span>)addLayoutManager:(<span class="built_in">NSLayoutManager</span> *)obj;</span><br><span class="line">- (<span class="keyword">void</span>)removeLayoutManager:(<span class="built_in">NSLayoutManager</span> *)obj;</span><br><span class="line">- (<span class="built_in">NSArray</span> *)layoutManagers;</span><br></pre></td></tr></table></figure>

<p>注意，如果返回的集合是无序的，使用<code>NSSet</code>来代替<code>NSArray</code>。如果需要将元素插入到特定的位置，使用类似于这样的命名：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">- (<span class="keyword">void</span>)insertLayoutManager:(<span class="built_in">NSLayoutManager</span> *)obj atIndex:(<span class="keyword">int</span>)index;</span><br><span class="line">- (<span class="keyword">void</span>)removeLayoutManagerAtIndex:(<span class="keyword">int</span>)index;</span><br></pre></td></tr></table></figure>

<h3 id="2-9-命名函数（Functions）"><a href="#2-9-命名函数（Functions）" class="headerlink" title="2.9 命名函数（Functions）"></a>2.9 命名函数（Functions）</h3><p>在很多场合仍然需要用到函数，比如说如果一个对象是一个单例，那么应该使用函数来代替类方法执行相关操作。</p>
<p>函数的命名和方法有一些不同，主要是：</p>
<ul>
<li>函数名称一般带有缩写前缀，表示方法所在的框架。</li>
<li>前缀后的单词以“驼峰”表示法显示，第一个单词首字母大写。</li>
</ul>
<p>函数名的第一个单词通常是一个动词，表示方法执行的操作：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSHighlightRect</span></span><br><span class="line"><span class="built_in">NSDeallocateObject</span></span><br></pre></td></tr></table></figure>

<p>如果函数返回其参数的某个属性，省略动词：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">unsigned</span> <span class="keyword">int</span> <span class="built_in">NSEventMaskFromType</span>(<span class="built_in">NSEventType</span> type)</span><br><span class="line"><span class="keyword">float</span> <span class="built_in">NSHeight</span>(<span class="built_in">NSRect</span> aRect)</span><br></pre></td></tr></table></figure>

<p>如果函数通过指针参数来返回值，需要在函数名中使用<code>Get</code>：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *<span class="built_in">NSGetSizeAndAlignment</span>(<span class="keyword">const</span> <span class="keyword">char</span> *typePtr, <span class="keyword">unsigned</span> <span class="keyword">int</span> *sizep, <span class="keyword">unsigned</span> <span class="keyword">int</span> *alignp)</span><br></pre></td></tr></table></figure>

<p>函数的返回类型是BOOL时的命名：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">BOOL</span> <span class="built_in">NSDecimalIsNotANumber</span>(<span class="keyword">const</span> <span class="built_in">NSDecimal</span> *decimal)</span><br></pre></td></tr></table></figure>

<h3 id="2-10-命名属性和实例变量（Properties-amp-Instance-Variables）"><a href="#2-10-命名属性和实例变量（Properties-amp-Instance-Variables）" class="headerlink" title="2.10 命名属性和实例变量（Properties&amp;Instance Variables）"></a>2.10 命名属性和实例变量（Properties&amp;Instance Variables）</h3><p>属性和对象的存取方法相关联，属性的第一个字母小写，后续单词首字母大写，不必添加前缀。属性按功能命名成名词或者动词：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//名词属性</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">strong</span>) <span class="built_in">NSString</span> *title;</span><br><span class="line"></span><br><span class="line"><span class="comment">//动词属性</span></span><br><span class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>) <span class="built_in">BOOL</span> showsAlpha;</span><br></pre></td></tr></table></figure>

<p>属性也可以命名成形容词，这时候通常会指定一个带有<code>is</code>前缀的get方法来提高可读性：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@property</span> (<span class="keyword">assign</span>, <span class="keyword">getter</span>=isEditable) <span class="built_in">BOOL</span> editable;</span><br></pre></td></tr></table></figure>

<p>命名实例变量，在变量名前加上<code>_</code>前缀，其它和命名属性一样：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">@implementation</span> <span class="title">MyClass</span> </span>&#123;</span><br><span class="line">    <span class="built_in">BOOL</span> _showsTitle;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>一般来说，类需要对使用者隐藏数据存储的细节，所以不要将实例方法定义成公共可访问的接口，可以使用<code>@private</code>，<code>@protected</code>前缀。</p>
<h3 id="2-11-命名常量（Constants）"><a href="#2-11-命名常量（Constants）" class="headerlink" title="2.11 命名常量（Constants）"></a>2.11 命名常量（Constants）</h3><p>如果要定义一组相关的常量，尽量使用枚举类型（enumerations），枚举类型的命名规则和函数的命名规则相同。<br>建议使用 <code>NS_ENUM</code> 和 <code>NS_OPTIONS</code> 宏来定义枚举类型，参见官方的 <a href="https://developer.apple.com/library/ios/releasenotes/ObjectiveC/ModernizationObjC/AdoptingModernObjective-C/AdoptingModernObjective-C.html" target="_blank" rel="noopener">Adopting Modern Objective-C</a> 一文：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 定义一个枚举</span></span><br><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_ENUM</span>(<span class="built_in">NSInteger</span>, <span class="built_in">NSMatrixMode</span>) &#123;</span><br><span class="line">    <span class="built_in">NSRadioModeMatrix</span>,</span><br><span class="line">    <span class="built_in">NSHighlightModeMatrix</span>,</span><br><span class="line">    <span class="built_in">NSListModeMatrix</span>,</span><br><span class="line">    <span class="built_in">NSTrackModeMatrix</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>定义bit map：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="built_in">NS_OPTIONS</span>(<span class="built_in">NSUInteger</span>, <span class="built_in">NSWindowMask</span>) &#123;</span><br><span class="line">    <span class="built_in">NSBorderlessWindowMask</span>      = <span class="number">0</span>,</span><br><span class="line">    <span class="built_in">NSTitledWindowMask</span>          = <span class="number">1</span> &lt;&lt; <span class="number">0</span>,</span><br><span class="line">    <span class="built_in">NSClosableWindowMask</span>        = <span class="number">1</span> &lt;&lt; <span class="number">1</span>,</span><br><span class="line">    <span class="built_in">NSMiniaturizableWindowMask</span>  = <span class="number">1</span> &lt;&lt; <span class="number">2</span>,</span><br><span class="line">    <span class="built_in">NSResizableWindowMask</span>       = <span class="number">1</span> &lt;&lt; <span class="number">3</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>使用<code>const</code>定义浮点型或者单个的整数型常量，如果要定义一组相关的整数常量，应该优先使用枚举。常量的命名规范和函数相同：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">float</span> <span class="built_in">NSLightGray</span>;</span><br></pre></td></tr></table></figure>

<p>不要使用<code>#define</code>宏来定义常量，如果是整型常量，尽量使用枚举，浮点型常量，使用<code>const</code>定义。<code>#define</code>通常用来给编译器决定是否编译某块代码，比如常用的：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">ifdef</span> DEBUG</span></span><br></pre></td></tr></table></figure>

<p>注意到一般由编译器定义的宏会在前后都有一个<code>__</code>，比如<em><code>__MACH__</code></em>。</p>
<h3 id="2-12-命名通知（Notifications）"><a href="#2-12-命名通知（Notifications）" class="headerlink" title="2.12 命名通知（Notifications）"></a>2.12 命名通知（Notifications）</h3><p>通知常用于在模块间传递消息，所以通知要尽可能地表示出发生的事件，通知的命名范式是：</p>
<pre><code>[触发通知的类名] + [Did | Will] + [动作] + Notification</code></pre><p>Example：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSApplicationDidBecomeActiveNotification</span></span><br><span class="line"><span class="built_in">NSWindowDidMiniaturizeNotification</span></span><br><span class="line"><span class="built_in">NSTextViewDidChangeSelectionNotification</span></span><br><span class="line"><span class="built_in">NSColorPanelColorDidChangeNotification</span></span><br></pre></td></tr></table></figure>

<h2 id="三、注释"><a href="#三、注释" class="headerlink" title="三、注释"></a>三、注释</h2><p>读没有注释代码的痛苦你我都体会过，好的注释不仅能让人轻松读懂你的程序，还能提升代码的逼格。注意注释是为了让别人看懂，而不是仅仅你自己。</p>
<h3 id="3-1-文件注释"><a href="#3-1-文件注释" class="headerlink" title="3.1 文件注释"></a>3.1 文件注释</h3><p>每一个文件都<strong>必须</strong>写文件注释，简单描述文件的内容和作用</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  CListViewController.h</span></span><br><span class="line"><span class="comment">//  BCRM-iOS</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">//  Created by xiao on 2017/3/3.</span></span><br><span class="line"><span class="comment">//  Copyright © 2017年 xiao. All rights reserved.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> *  渠道商列表页</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="meta">#import <span class="meta-string">"BaseViewController.h"</span></span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">@interface</span> <span class="title">CListViewController</span> : <span class="title">BaseViewController</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@end</span></span><br></pre></td></tr></table></figure>

<p><strong>文件注释的格式通常不作要求，能清晰易读就可以了，但在整个工程中风格要统一。</strong></p>
<h3 id="3-2-代码注释"><a href="#3-2-代码注释" class="headerlink" title="3.2 代码注释"></a>3.2 代码注释</h3><p>好的代码应该是“自解释”（self-documenting）的，但仍然需要详细的注释来说明参数的意义、返回值、功能以及可能的副作用。</p>
<p>方法、函数、类、协议、类别的定义都需要注释，推荐采用Apple的标准注释风格，好处是可以在引用的地方<code>alt+点击</code>自动弹出注释，非常方便。</p>
<p><strong>Xcode快捷方式：Option + Command + /，可以自动生成Apple标准风格的注释</strong></p>
<p>一些良好的注释：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 空数据占位图即将出现</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment"> @param scrollView 空数据占位图关联的scrollView</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)emptyDataSetWillAppear:(<span class="built_in">UIScrollView</span> *)scrollView；</span><br><span class="line"></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> 结束刷新</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line">- (<span class="keyword">void</span>)endRefreshing；</span><br></pre></td></tr></table></figure>

<p><strong>定义在头文件里的接口方法、属性必须要有注释！</strong></p>
<h2 id="四、编码风格"><a href="#四、编码风格" class="headerlink" title="四、编码风格"></a>四、编码风格</h2><p>每个人都有自己的编码风格，这里总结了一些比较好的Cocoa编程风格和注意点。</p>
<h3 id="4-1-不要使用new方法"><a href="#4-1-不要使用new方法" class="headerlink" title="4.1 不要使用new方法"></a>4.1 不要使用new方法</h3><p>尽管很多时候能用<code>new</code>代替<code>alloc init</code>方法，但这可能会导致调试内存时出现不可预料的问题。Cocoa的规范就是使用<code>alloc init</code>方法，使用<code>new</code>会让一些读者困惑。</p>
<h3 id="4-2-Public-API要尽量简洁"><a href="#4-2-Public-API要尽量简洁" class="headerlink" title="4.2 Public API要尽量简洁"></a>4.2 Public API要尽量简洁</h3><p>共有接口要设计的简洁，满足核心的功能需求就可以了。不要设计很少会被用到，但是参数极其复杂的API。如果要定义复杂的方法，使用类别或者类扩展。</p>
<h3 id="4-3-import和-include"><a href="#4-3-import和-include" class="headerlink" title="4.3 #import和#include"></a>4.3 #import和#include</h3><p><code>#import</code>是Cocoa中常用的引用头文件的方式，它能自动防止重复引用文件，什么时候使用<code>#import</code>，什么时候使用<code>#include</code>呢？</p>
<ul>
<li>当引用的是一个Objective-C或者Objective-C++的头文件时，使用<code>#import</code></li>
<li>当引用的是一个C或者C++的头文件时，使用<code>#include</code>，这时必须要保证被引用的文件提供了保护域（#define guard）。</li>
</ul>
<p>Example：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#import <span class="meta-string">&lt;UIKit/UIKit.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">"base/basictypes.h"</span></span></span><br></pre></td></tr></table></figure>

<p>为什么不全部使用<code>#import</code>呢？主要是为了保证代码在不同平台间共享时不出现问题。</p>
<h3 id="4-4-BOOL的使用"><a href="#4-4-BOOL的使用" class="headerlink" title="4.4 BOOL的使用"></a>4.4 BOOL的使用</h3><p>BOOL在Objective-C中被定义为<code>signed char</code>类型，这意味着一个BOOL类型的变量不仅仅可以表示<code>YES</code>(1)和<code>NO</code>(0)两个值，所以永远<strong>不要</strong>将BOOL类型变量直接和<code>YES</code>比较：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 错误，无法确定|great|的值是否是YES(1)，不要将BOOL值直接与YES比较</span></span><br><span class="line"><span class="built_in">BOOL</span> great = [foo isGreat];</span><br><span class="line"><span class="keyword">if</span> (great == <span class="literal">YES</span>)</span><br><span class="line">  <span class="comment">// ...be great!</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//正确</span></span><br><span class="line"><span class="built_in">BOOL</span> great = [foo isGreat];</span><br><span class="line"><span class="keyword">if</span> (great)</span><br><span class="line">  <span class="comment">// ...be great!</span></span><br></pre></td></tr></table></figure>

<p>同样的，也不要将其它类型的值作为BOOL来返回，这种情况下，BOOL变量只会取值的最后一个字节来赋值，这样很可能会取到0（NO）。但是，一些逻辑操作符比如<code>&amp;&amp;</code>,<code>||</code>,<code>!</code>的返回是可以直接赋给BOOL的：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 错误，不要将其它类型转化为BOOL返回</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)isBold &#123;</span><br><span class="line">  <span class="keyword">return</span> [<span class="keyword">self</span> fontTraits] &amp; <span class="built_in">NSFontBoldTrait</span>;</span><br><span class="line">&#125;</span><br><span class="line">- (<span class="built_in">BOOL</span>)isValid &#123;</span><br><span class="line">  <span class="keyword">return</span> [<span class="keyword">self</span> stringValue];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 正确</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)isBold &#123;</span><br><span class="line">  <span class="keyword">return</span> ([<span class="keyword">self</span> fontTraits] &amp; <span class="built_in">NSFontBoldTrait</span>) ? <span class="literal">YES</span> : <span class="literal">NO</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 正确，逻辑操作符可以直接转化为BOOL</span></span><br><span class="line">- (<span class="built_in">BOOL</span>)isValid &#123;</span><br><span class="line">  <span class="keyword">return</span> [<span class="keyword">self</span> stringValue] != <span class="literal">nil</span>;</span><br><span class="line">&#125;</span><br><span class="line">- (<span class="built_in">BOOL</span>)isEnabled &#123;</span><br><span class="line">  <span class="keyword">return</span> [<span class="keyword">self</span> isValid] &amp;&amp; [<span class="keyword">self</span> isBold];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>另外BOOL类型可以和<code>_Bool</code>,<code>bool</code>相互转化，但是<strong>不能</strong>和<code>Boolean</code>转化。</p>
<h3 id="4-5-在init和dealloc中不要用存取方法访问实例变量"><a href="#4-5-在init和dealloc中不要用存取方法访问实例变量" class="headerlink" title="4.5 在init和dealloc中不要用存取方法访问实例变量"></a>4.5 在init和dealloc中不要用存取方法访问实例变量</h3><p>当<code>init``dealloc</code>方法被执行时，类的运行时环境不是处于正常状态的，使用存取方法访问变量可能会导致不可预料的结果，因此应当在这两个方法内直接访问实例变量。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 正确，直接访问实例变量</span></span><br><span class="line">- (<span class="keyword">instancetype</span>)init &#123;</span><br><span class="line">  <span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">    _bar = [[<span class="built_in">NSMutableString</span> alloc] init];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line">- (<span class="keyword">void</span>)dealloc &#123;</span><br><span class="line">  [_bar release];</span><br><span class="line">  [<span class="keyword">super</span> dealloc];</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误，不要通过存取方法访问</span></span><br><span class="line">- (<span class="keyword">instancetype</span>)init &#123;</span><br><span class="line">  <span class="keyword">self</span> = [<span class="keyword">super</span> init];</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">self</span>) &#123;</span><br><span class="line">    <span class="keyword">self</span>.bar = [<span class="built_in">NSMutableString</span> string];</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">self</span>;</span><br><span class="line">&#125;</span><br><span class="line">- (<span class="keyword">void</span>)dealloc &#123;</span><br><span class="line">  <span class="keyword">self</span>.bar = <span class="literal">nil</span>;</span><br><span class="line">  [<span class="keyword">super</span> dealloc];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-6-按照定义的顺序释放资源"><a href="#4-6-按照定义的顺序释放资源" class="headerlink" title="4.6 按照定义的顺序释放资源"></a>4.6 按照定义的顺序释放资源</h3><p>在类或者Controller的生命周期结束时，往往需要做一些扫尾工作，比如释放资源，停止线程等，这些扫尾工作的释放顺序应当与它们的初始化或者定义的顺序保持一致。这样做是为了方便调试时寻找错误，也能防止遗漏。</p>
<h3 id="4-7-保证NSString在赋值时被复制"><a href="#4-7-保证NSString在赋值时被复制" class="headerlink" title="4.7 保证NSString在赋值时被复制"></a>4.7 保证NSString在赋值时被复制</h3><p><code>NSString</code>非常常用，在它被传递或者赋值时应当保证是以复制（copy）的方式进行的，这样可以防止在不知情的情况下String的值被其它对象修改。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@property</span> (<span class="keyword">copy</span>,<span class="keyword">nonatomic</span>) <span class="built_in">NSString</span> *text;</span><br></pre></td></tr></table></figure>

<h3 id="4-8-使用NSNumber的语法糖"><a href="#4-8-使用NSNumber的语法糖" class="headerlink" title="4.8 使用NSNumber的语法糖"></a>4.8 使用NSNumber的语法糖</h3><p>使用带有<code>@</code>符号的语法糖来生成NSNumber对象能使代码更简洁：</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">NSNumber</span> *fortyTwo = @<span class="number">42</span>;</span><br></pre></td></tr></table></figure>

<h3 id="4-9-nil检查"><a href="#4-9-nil检查" class="headerlink" title="4.9 nil检查"></a>4.9 nil检查</h3><p>因为在Objective-C中向nil对象发送命令是不会抛出异常或者导致崩溃的，只是完全的“什么都不干”，所以，只在程序中使用nil来做逻辑上的检查。</p>
<p>另外，不要使用诸如<code>nil == Object</code>或者<code>Object == nil</code>的形式来判断。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 正确，直接判断</span></span><br><span class="line"><span class="keyword">if</span> (!objc) &#123;</span><br><span class="line">	...	</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 错误，不要使用nil == Object的形式</span></span><br><span class="line"><span class="keyword">if</span> (<span class="literal">nil</span> == objc) &#123;</span><br><span class="line">	...	</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="4-10-属性的线程安全"><a href="#4-10-属性的线程安全" class="headerlink" title="4.10 属性的线程安全"></a>4.10 属性的线程安全</h3><p>定义一个属性时，编译器会自动生成线程安全的存取方法（Atomic），但这样会大大降低性能，特别是对于那些需要频繁存取的属性来说，是极大的浪费。所以如果定义的属性不需要线程保护，记得手动添加属性关键字<code>nonatomic</code>来取消编译器的优化。</p>
<h3 id="4-11-点语法的使用"><a href="#4-11-点语法的使用" class="headerlink" title="4.11 点语法的使用"></a>4.11 点语法的使用</h3><p>不要用点语法来调用方法，只用来访问属性。这样是为了防止代码可读性问题。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//正确，使用点分语法访问属性</span></span><br><span class="line"><span class="built_in">NSString</span> *oldName = myObject.name;</span><br><span class="line">myObject.name = <span class="string">@"Alice"</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//错误，不要用点分语法调用方法</span></span><br><span class="line"><span class="built_in">NSArray</span> *array = [<span class="built_in">NSArray</span> arrayWithObject:<span class="string">@"hello"</span>];</span><br><span class="line"><span class="built_in">NSUInteger</span> numberOfItems = array.count;</span><br><span class="line">array.release;</span><br></pre></td></tr></table></figure>

<h3 id="4-12-Delegate要使用弱引用"><a href="#4-12-Delegate要使用弱引用" class="headerlink" title="4.12 Delegate要使用弱引用"></a>4.12 Delegate要使用弱引用</h3><p>一个类的Delegate对象通常还引用着类本身，这样很容易造成引用循环的问题，所以类的Delegate属性要设置为弱引用。</p>
<figure class="highlight objectivec"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">@property</span> (<span class="keyword">nonatomic</span>, <span class="keyword">weak</span>) <span class="keyword">id</span> &lt;IPCConnectHandlerDelegate&gt; delegate;</span><br></pre></td></tr></table></figure></div><div class="tags"></div><div class="post-nav"><a class="pre" href="/2017/05/31/%E4%BD%BF%E7%94%A8Shell%E8%84%9A%E6%9C%AC%E6%89%B9%E9%87%8F%E5%8E%8B%E7%BC%A9%E5%9B%BE%E7%89%87/">使用Shell脚本批量压缩图片</a><a class="next" href="/2017/04/11/%E9%82%93%E7%99%BD%E6%B0%8F%E7%A0%81%E4%BF%A1%E6%81%AF%E6%9F%A5%E8%AF%A2/">邓白氏码信息查询</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://yoursite.com"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/Apple/">Apple</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Document/">Document</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Fastlane/">Fastlane</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Hexo/">Hexo</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Linux/">Linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Mac/">Mac</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Reader/">Reader</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Shell/">Shell</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/iOS/">iOS</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/Core-Animation/" style="font-size: 15px;">Core Animation</a> <a href="/tags/Tips/" style="font-size: 15px;">Tips</a> <a href="/tags/Github/" style="font-size: 15px;">Github</a> <a href="/tags/JSPatch/" style="font-size: 15px;">JSPatch</a> <a href="/tags/blueprint/" style="font-size: 15px;">blueprint</a> <a href="/tags/Base/" style="font-size: 15px;">Base</a> <a href="/tags/%E5%9F%8B%E7%82%B9/" style="font-size: 15px;">埋点</a> <a href="/tags/Xcode/" style="font-size: 15px;">Xcode</a> <a href="/tags/UDID/" style="font-size: 15px;">UDID</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/2020/05/05/hello-world/">Hello World</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/26/fastlane-cert/">自动化配置iOS开发者证书</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/11/17/APP-Download-Link/">APP Download Link</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/26/Transporter-Error-Output/">Transporter Error Output</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/18/Byte-array-to-UIImage/">Byte数组转化为UIImage</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/16/iOS-YTKNetwork-HTTPS/">iOS YTKNetwork 适配 HTTPS</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/10/16/iOS-AFNetworking-HTTPS/">iOS AFNetworking 适配 HTTPS</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/31/%E4%BD%BF%E7%94%A8Shell%E8%84%9A%E6%9C%AC%E6%89%B9%E9%87%8F%E5%8E%8B%E7%BC%A9%E5%9B%BE%E7%89%87/">使用Shell脚本批量压缩图片</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/05/23/Objective-C-Coding-Guidelines/">Objective-C Coding Guidelines</a></li><li class="post-list-item"><a class="post-list-link" href="/2017/04/11/%E9%82%93%E7%99%BD%E6%B0%8F%E7%A0%81%E4%BF%A1%E6%81%AF%E6%9F%A5%E8%AF%A2/">邓白氏码信息查询</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2020 <a href="/." rel="nofollow">Xiao.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css"><script type="text/javascript" src="/js/copycode.js" successtext="复制成功!"></script><link rel="stylesheet" type="text/css" href="/css/copycode.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>